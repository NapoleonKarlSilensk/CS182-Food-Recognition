# é£Ÿç‰©éŸ³é¢‘è¯†åˆ«é¡¹ç›® - æ€»ç»“æŠ¥å‘Š

## ğŸ“Š é¡¹ç›®æ¦‚è¿°

**é¡¹ç›®ç›®æ ‡**: é€šè¿‡æœºå™¨å­¦ä¹ è¯†åˆ«éŸ³é¢‘ä¸­æ­£åœ¨é£Ÿç”¨çš„é£Ÿç‰©ç±»åˆ«

**å®Œæˆæ—¶é—´**: 2025å¹´12æœˆ20æ—¥

**GitHubä»“åº“**: https://github.com/NapoleonKarlSilensk/CS182-Food-Recognition

---

## ğŸ¯ æœ€ç»ˆç»“æœ

### æ¨¡å‹æ€§èƒ½
- **éªŒè¯å‡†ç¡®ç‡**: 57.86%
- **è®­ç»ƒæ ·æœ¬æ•°**: 5,600
- **éªŒè¯æ ·æœ¬æ•°**: 1,400
- **æµ‹è¯•é›†é¢„æµ‹**: å·²å®Œæˆtest_aå’Œtest_bï¼ˆå„2000ä¸ªæ ·æœ¬ï¼‰
- **è®­ç»ƒæ—¶é•¿**: 85.44åˆ†é’Ÿ

### æäº¤æ–‡ä»¶
- âœ… `submission_test_a_20251220_025935.csv` (2000æ¡é¢„æµ‹)
- âœ… `submission_test_b_20251220_025935.csv` (2000æ¡é¢„æµ‹)

---

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
CS182proj-me/
â”œâ”€â”€ config.py                    # é…ç½®æ–‡ä»¶ï¼ˆæ”¯æŒtrain/train_sampleåˆ‡æ¢ï¼‰
â”œâ”€â”€ data_preprocessing.py        # éŸ³é¢‘æ•°æ®åŠ è½½å’ŒMelé¢‘è°±æå–
â”œâ”€â”€ model.py                     # CNNæ¨¡å‹æ¶æ„
â”œâ”€â”€ train.py                     # è®­ç»ƒè„šæœ¬
â”œâ”€â”€ predict.py                   # é¢„æµ‹è„šæœ¬ï¼ˆbatchå¤„ç†test_aå’Œtest_bï¼‰
â”œâ”€â”€ validate.py                  # éªŒè¯è„šæœ¬ï¼ˆæ£€æŸ¥train_sampleå‡†ç¡®ç‡ï¼‰
â”œâ”€â”€ check_data.py                # æ•°æ®éªŒè¯è„šæœ¬
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ cnn_full_best.h5         # æœ€ä½³æ¨¡å‹ï¼ˆå®Œæ•´è®­ç»ƒï¼‰
â”‚   â”œâ”€â”€ cnn_full_final.h5        # æœ€ç»ˆæ¨¡å‹
â”‚   â”œâ”€â”€ cnn_full_training_history.png  # è®­ç»ƒæ›²çº¿
â”‚   â”œâ”€â”€ cnn_full_info.txt        # è®­ç»ƒä¿¡æ¯
â”‚   â”œâ”€â”€ confusion_matrix_validation.png  # æ··æ·†çŸ©é˜µ
â”‚   â””â”€â”€ validation_results.txt   # éªŒè¯è¯¦ç»†æŠ¥å‘Š
â”œâ”€â”€ submissions/
â”‚   â”œâ”€â”€ submission_test_a_20251220_025935.csv
â”‚   â””â”€â”€ submission_test_b_20251220_025935.csv
â””â”€â”€ README.md                    # é¡¹ç›®è¯´æ˜
```

---

## ğŸ”§ æŠ€æœ¯å®ç°

### 1. æ•°æ®å¤„ç†
- **éŸ³é¢‘æ ¼å¼**: WAVæ–‡ä»¶
- **é‡‡æ ·ç‡**: 22,050 Hz
- **éŸ³é¢‘é•¿åº¦**: å›ºå®š5ç§’ï¼ˆå¡«å……/æˆªæ–­ï¼‰
- **ç‰¹å¾æå–**: Melé¢‘è°±å›¾
  - Mel bands: 128
  - Time frames: 216
  - å½’ä¸€åŒ–: [0, 1]

### 2. æ¨¡å‹æ¶æ„
```
CNNæ¨¡å‹ï¼ˆç®€åŒ–ç‰ˆï¼‰
â”œâ”€â”€ Conv2D(32) + MaxPooling + Dropout(0.3)
â”œâ”€â”€ Conv2D(64) + MaxPooling + Dropout(0.4)
â”œâ”€â”€ Conv2D(128) + MaxPooling + Dropout(0.5)
â”œâ”€â”€ GlobalAveragePooling2D
â”œâ”€â”€ Dense(128, L2æ­£åˆ™åŒ–0.01) + Dropout(0.5)
â””â”€â”€ Dense(20, softmax)

æ€»å‚æ•°: 111,764
```

### 3. è®­ç»ƒé…ç½®
- **ä¼˜åŒ–å™¨**: Adam (lr=0.001)
- **æ‰¹æ¬¡å¤§å°**: 32
- **æœ€å¤§è½®æ•°**: 200
- **æ—©åœ**: patience=20
- **å­¦ä¹ ç‡è¡°å‡**: ReduceLROnPlateau (patience=8)
- **æ•°æ®åˆ†å‰²**: 80% è®­ç»ƒ / 20% éªŒè¯

### 4. é£Ÿç‰©ç±»åˆ«ï¼ˆ20ç±»ï¼‰
1. aloe (èŠ¦èŸ)
2. burger (æ±‰å ¡)
3. cabbage (å·å¿ƒèœ)
4. candied_fruits (èœœé¥¯)
5. carrots (èƒ¡èåœ)
6. chips (è–¯ç‰‡)
7. chocolate (å·§å…‹åŠ›)
8. drinks (é¥®æ–™)
9. fries (è–¯æ¡)
10. grapes (è‘¡è„)
11. gummies (è½¯ç³–)
12. ice-cream (å†°æ·‡æ·‹)
13. jelly (æœå†»)
14. noodles (é¢æ¡)
15. pickles (æ³¡èœ)
16. pizza (æŠ«è¨)
17. ribs (æ’éª¨)
18. salmon (ä¸‰æ–‡é±¼)
19. soup (æ±¤)
20. wings (é¸¡ç¿…)

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å†ç¨‹

### ç¬¬ä¸€é˜¶æ®µï¼šåˆå§‹æ¨¡å‹ï¼ˆè¿‡æ‹Ÿåˆä¸¥é‡ï¼‰
- **é—®é¢˜**: éªŒè¯å‡†ç¡®ç‡ä»…6-7%ï¼Œæ¨¡å‹é¢„æµ‹é›†ä¸­åœ¨1-2ä¸ªç±»åˆ«
- **åŸå› **: æ¨¡å‹è¿‡äºå¤æ‚ï¼ˆ4å±‚å·ç§¯ + BatchNormï¼‰ï¼Œæ•°æ®é‡å°
- **è¡¨ç°**: è®­ç»ƒå‡†ç¡®ç‡ä¸Šå‡ï¼ŒéªŒè¯å‡†ç¡®ç‡åœæ»

### ç¬¬äºŒé˜¶æ®µï¼šç®€åŒ–æ¨¡å‹
- **æ”¹è¿›**: 
  - ç§»é™¤ç¬¬4å±‚å·ç§¯
  - ç§»é™¤BatchNormalization
  - å‡å°‘å…¨è¿æ¥å±‚ï¼ˆ512â†’256 æ”¹ä¸º 128ï¼‰
  - å¢åŠ L2æ­£åˆ™åŒ–å’ŒDropout
- **ç»“æœ**: train_sampleéªŒè¯å‡†ç¡®ç‡æå‡åˆ°36%

### ç¬¬ä¸‰é˜¶æ®µï¼šå®Œæ•´æ•°æ®è®­ç»ƒ
- **æ”¹è¿›**: ä½¿ç”¨å®Œæ•´trainæ•°æ®é›†ï¼ˆ7000æ ·æœ¬ï¼‰
- **ç»“æœ**: éªŒè¯å‡†ç¡®ç‡æå‡åˆ°**57.86%**

---

## ğŸ“Š è¯¦ç»†æ€§èƒ½åˆ†æ

### å„ç±»åˆ«å‡†ç¡®ç‡ï¼ˆtrain_sampleéªŒè¯ï¼‰
è¡¨ç°æœ€å¥½çš„ç±»åˆ«ï¼š
- burger: 79.69%
- ice-cream: 69.57%
- fries: 54.39%

è¡¨ç°è¾ƒå·®çš„ç±»åˆ«ï¼š
- chocolate, noodles, ribs, soup, wings: 0%ï¼ˆæ ·æœ¬é‡å°ï¼‰
- carrots: 6.12%
- salmon: 2.70%

### Testé›†é¢„æµ‹åˆ†å¸ƒ
**Test A** (2000ä¸ªæ ·æœ¬):
- æœ€å¤š: candied_fruits (197)
- æœ€å°‘: chocolate (22)

**Test B** (2000ä¸ªæ ·æœ¬):
- æœ€å¤š: candied_fruits (224)
- æœ€å°‘: chocolate (29)

---

## ğŸš€ å¦‚ä½•ä½¿ç”¨

### 1. ç¯å¢ƒé…ç½®
```bash
pip install tensorflow librosa numpy pandas scikit-learn matplotlib tqdm
```

### 2. å¿«é€ŸéªŒè¯ï¼ˆä½¿ç”¨train_sampleï¼‰
```bash
# ä¿®æ”¹config.py: USE_SAMPLE_DATA = True
python train.py      # è®­ç»ƒæ¨¡å‹
python validate.py   # éªŒè¯å‡†ç¡®ç‡
```

### 3. å®Œæ•´è®­ç»ƒ
```bash
# ä¿®æ”¹config.py: USE_SAMPLE_DATA = False
python train.py      # è®­ç»ƒæ¨¡å‹ï¼ˆçº¦85åˆ†é’Ÿï¼‰
python predict.py    # ç”Ÿæˆtest_aå’Œtest_bé¢„æµ‹
```

### 4. ä»…é¢„æµ‹
```bash
python predict.py    # ä½¿ç”¨å·²æœ‰æ¨¡å‹é¢„æµ‹
```

---

## ğŸ’¡ æ”¹è¿›å»ºè®®

### çŸ­æœŸä¼˜åŒ–
1. **æ•°æ®å¢å¼º**:
   - æ—¶é—´æ‹‰ä¼¸/å‹ç¼©
   - æ·»åŠ èƒŒæ™¯å™ªå£°
   - éŸ³è°ƒå˜æ¢

2. **æ¨¡å‹è°ƒæ•´**:
   - å°è¯•ä¸åŒçš„å·ç§¯æ ¸å¤§å°
   - è°ƒæ•´Dropoutæ¯”ä¾‹
   - å®éªŒä¸åŒçš„ç‰¹å¾ï¼ˆMFCC, Chromaç­‰ï¼‰

3. **é›†æˆå­¦ä¹ **:
   - è®­ç»ƒå¤šä¸ªæ¨¡å‹æŠ•ç¥¨
   - ä½¿ç”¨ä¸åŒçš„éšæœºç§å­

### é•¿æœŸä¼˜åŒ–
1. æ”¶é›†æ›´å¤šè®­ç»ƒæ•°æ®ï¼ˆç‰¹åˆ«æ˜¯è¡¨ç°å·®çš„ç±»åˆ«ï¼‰
2. å°è¯•é¢„è®­ç»ƒæ¨¡å‹ï¼ˆVGGish, YAMNetç­‰ï¼‰
3. ä½¿ç”¨æ³¨æ„åŠ›æœºåˆ¶
4. å°è¯•Transformeræ¶æ„

---

## ğŸ“ æ–‡ä»¶æ¸…å•

### æ ¸å¿ƒä»£ç 
- [x] config.py - é…ç½®ç®¡ç†
- [x] data_preprocessing.py - æ•°æ®åŠ è½½
- [x] model.py - æ¨¡å‹å®šä¹‰
- [x] train.py - è®­ç»ƒæµç¨‹
- [x] predict.py - é¢„æµ‹æµç¨‹
- [x] validate.py - éªŒè¯å·¥å…·

### æ¨¡å‹æ–‡ä»¶
- [x] cnn_full_best.h5 - æœ€ä½³æ¨¡å‹
- [x] cnn_full_final.h5 - æœ€ç»ˆæ¨¡å‹
- [x] cnn_sample_best.h5 - æ ·æœ¬è®­ç»ƒæ¨¡å‹

### æäº¤æ–‡ä»¶
- [x] submission_test_a_20251220_025935.csv
- [x] submission_test_b_20251220_025935.csv

### å¯è§†åŒ–ç»“æœ
- [x] cnn_full_training_history.png - è®­ç»ƒæ›²çº¿
- [x] confusion_matrix_validation.png - æ··æ·†çŸ©é˜µ
- [x] validation_results.txt - è¯¦ç»†éªŒè¯æŠ¥å‘Š

---

## ğŸ“ é¡¹ç›®æ€»ç»“

æœ¬é¡¹ç›®æˆåŠŸå®ç°äº†åŸºäºCNNçš„éŸ³é¢‘é£Ÿç‰©è¯†åˆ«ç³»ç»Ÿï¼Œé€šè¿‡Melé¢‘è°±ç‰¹å¾æå–å’Œæ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œåœ¨20ç±»é£Ÿç‰©è¯†åˆ«ä»»åŠ¡ä¸Šè¾¾åˆ°äº†57.86%çš„éªŒè¯å‡†ç¡®ç‡ã€‚

**å…³é”®æˆå°±**:
1. âœ… å®Œæ•´çš„æœºå™¨å­¦ä¹ pipelineï¼ˆæ•°æ®â†’è®­ç»ƒâ†’éªŒè¯â†’é¢„æµ‹ï¼‰
2. âœ… çµæ´»çš„é…ç½®ç³»ç»Ÿï¼ˆtrain/train_sampleåˆ‡æ¢ï¼‰
3. âœ… è¯¦ç»†çš„æ€§èƒ½åˆ†æå’Œå¯è§†åŒ–
4. âœ… æˆåŠŸè§£å†³è¿‡æ‹Ÿåˆé—®é¢˜ï¼ˆä»7%æå‡åˆ°58%ï¼‰
5. âœ… å®Œæˆtest_aå’Œtest_bçš„é¢„æµ‹æäº¤

**å­¦åˆ°çš„ç»éªŒ**:
- ç®€åŒ–æ¨¡å‹æ¶æ„æ¯”å¢åŠ å¤æ‚åº¦æ›´æœ‰æ•ˆ
- æ•°æ®é‡å¯¹æ€§èƒ½å½±å“å·¨å¤§ï¼ˆ1000â†’7000æ ·æœ¬ï¼Œ36%â†’58%ï¼‰
- æ­£åˆ™åŒ–ï¼ˆDropout, L2ï¼‰å¯¹é˜²æ­¢è¿‡æ‹Ÿåˆè‡³å…³é‡è¦
- æ—©åœå’Œå­¦ä¹ ç‡è¡°å‡èƒ½æ˜¾è‘—æå‡è®­ç»ƒæ•ˆç‡

---

## ğŸ“§ è”ç³»æ–¹å¼

**GitHub**: https://github.com/NapoleonKarlSilensk/CS182-Food-Recognition

**é¡¹ç›®å®Œæˆæ—¥æœŸ**: 2025å¹´12æœˆ20æ—¥
